# Recreating data in an R dataframe
df <- read.table(text="DATE Google_trends
01/01/2004	18
01/02/2004	16
01/03/2004	27
01/04/2004	31
01/05/2004	15
01/06/2004	24
01/07/2004	10
01/08/2004	13
01/09/2004	36
01/10/2004	21
01/11/2004	18
01/12/2004	37
01/01/2005	22
01/02/2005	18
01/03/2005	25
01/04/2005	12
01/05/2005	24
01/06/2005	19
01/07/2005	18
01/08/2005	28
01/09/2005	22
01/10/2005	34
01/11/2005	23
01/12/2005	37
01/01/2006	20
01/02/2006	29
01/03/2006	30
01/04/2006	24
01/05/2006	27
01/06/2006	18
01/07/2006	24
01/08/2006	24
01/09/2006	25
01/10/2006	25
01/11/2006	31
01/12/2006	35
01/01/2007	25
01/02/2007	24
01/03/2007	21
01/04/2007	27
01/05/2007	20
01/06/2007	32
01/07/2007	27
01/08/2007	28
01/09/2007	32
01/10/2007	39
01/11/2007	49
01/12/2007	46
01/01/2008	27
01/02/2008	31
01/03/2008	30
01/04/2008	46
01/05/2008	35
01/06/2008	31
01/07/2008	33
01/08/2008	35
01/09/2008	35
01/10/2008	31
01/11/2008	31
01/12/2008	39
01/01/2009	35
01/02/2009	33
01/03/2009	33
01/04/2009	28
01/05/2009	30
01/06/2009	25
01/07/2009	26
01/08/2009	31
01/09/2009	25
01/10/2009	24
01/11/2009	33
01/12/2009	31
01/01/2010	26
01/02/2010	28
01/03/2010	30
01/04/2010	29
01/05/2010	32
01/06/2010	25
01/07/2010	31
01/08/2010	34
01/09/2010	31
01/10/2010	31
01/11/2010	35
01/12/2010	38
01/01/2011	31
01/02/2011	27
01/03/2011	27
01/04/2011	32
01/05/2011	33
01/06/2011	31
01/07/2011	38
01/08/2011	33
01/09/2011	32
01/10/2011	30
01/11/2011	36
01/12/2011	37
01/01/2012	36
01/02/2012	33
01/03/2012	31
01/04/2012	41
01/05/2012	68
01/06/2012	42
01/07/2012	57
01/08/2012	60
01/09/2012	49
01/10/2012	46
01/11/2012	50
01/12/2012	59
01/01/2013	53
01/02/2013	45
01/03/2013	45
01/04/2013	42
01/05/2013	44
01/06/2013	45
01/07/2013	47
01/08/2013	50
01/09/2013	42
01/10/2013	42
01/11/2013	46
01/12/2013	45
01/01/2014	43
01/02/2014	43
01/03/2014	41
01/04/2014	42
01/05/2014	44
01/06/2014	45
01/07/2014	43
01/08/2014	45
01/09/2014	44
01/10/2014	44
01/11/2014	49
01/12/2014	51
01/01/2015	47
01/02/2015	47
01/03/2015	51
01/04/2015	50
01/05/2015	48
01/06/2015	50
01/07/2015	50
01/08/2015	51
01/09/2015	49
01/10/2015	49
01/11/2015	59
01/12/2015	60
01/01/2016	54
01/02/2016	50
01/03/2016	50
01/04/2016	51
01/05/2016	48
01/06/2016	52
01/07/2016	49
01/08/2016	47
01/09/2016	52
01/10/2016	55
01/11/2016	63
01/12/2016	72
01/01/2017	60
01/02/2017	54
01/03/2017	55
01/04/2017	58
01/05/2017	53
01/06/2017	57
01/07/2017	56
01/08/2017	58
01/09/2017	63
01/10/2017	68
01/11/2017	70
01/12/2017	72
01/01/2018	61
01/02/2018	58
01/03/2018	56
01/04/2018	57
01/05/2018	55
01/06/2018	59
01/07/2018	62
01/08/2018	60
01/09/2018	63
01/10/2018	63
01/11/2018	68
01/12/2018	69
01/01/2019	65
01/02/2019	58
01/03/2019	57
01/04/2019	59
01/05/2019	63
01/06/2019	62
01/07/2019	62
01/08/2019	61
01/09/2019	67
01/10/2019	62
01/11/2019	75
01/12/2019	84
01/01/2020	69
01/02/2020	58
01/03/2020	50
01/04/2020	50
01/05/2020	54
01/06/2020	63
01/07/2020	61
01/08/2020	65
01/09/2020	63
01/10/2020	61
01/11/2020	65
01/12/2020	68
01/01/2021	68
01/02/2021	64
01/03/2021	57
01/04/2021	57
01/05/2021	60
01/06/2021	60
01/07/2021	60
01/08/2021	62
01/09/2021	66
01/10/2021	62
01/11/2021	73
01/12/2021	82
01/01/2022	79
01/02/2022	73
01/03/2022	73
01/04/2022	78
01/05/2022	77
01/06/2022	76
01/07/2022	81
01/08/2022	76
01/09/2022	81
01/10/2022	79
01/11/2022	87
01/12/2022	98
01/01/2023	88
01/02/2023	87
01/03/2023	88
01/04/2023	96
01/05/2023	100",header = TRUE)


# Convert DATE column to date format
df$DATE <- as.Date(df$DATE, format="%d/%m/%Y")

# Create a sequence of dates on a weekly time frame
all_dates <- seq(from=min(df$DATE), to=max(df$DATE), by="week")

# Create a new data frame with all_dates as the date column
new_df <- data.frame(DATE=all_dates)

# Merge the new data frame with the original data frame
df_merged <- merge(df, new_df, all=TRUE)

# Interpolate missing values
library(zoo)
df_merged$Google_trends <- na.approx(df_merged$Google_trends)

# Final output data frame
final_df <- df_merged

# Export final data frame as csv for further processing in Python
# write.csv(final_df, "C:\\Users\\Hriday Govind\\Documents\\MSc\\Thesis Final Submission\\Data\\google_trends.csv", row.names = FALSE) # Uncomment if needed