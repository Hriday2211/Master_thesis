# Recreating data in an R dataframe
df <- read.table(text="DATE CCI
01/01/2017	101.3821
01/02/2017	101.3695
01/03/2017	101.3381
01/04/2017	101.2973
01/05/2017	101.2242
01/06/2017	101.1154
01/07/2017	101.0732
01/08/2017	101.1723
01/09/2017	101.2965
01/10/2017	101.4503
01/11/2017	101.4297
01/12/2017	101.3449
01/01/2018	101.375
01/02/2018	101.5388
01/03/2018	101.6406
01/04/2018	101.5894
01/05/2018	101.503
01/06/2018	101.4447
01/07/2018	101.413
01/08/2018	101.4244
01/09/2018	101.5082
01/10/2018	101.4903
01/11/2018	101.3805
01/12/2018	101.2093
01/01/2019	101.0043
01/02/2019	101.0587
01/03/2019	101.2775
01/04/2019	101.438
01/05/2019	101.5262
01/06/2019	101.432
01/07/2019	101.1993
01/08/2019	100.9022
01/09/2019	100.9021
01/10/2019	101.1057
01/11/2019	101.3753
01/12/2019	101.6039
01/01/2020	101.6023
01/02/2020	101.1728
01/03/2020	100.1714
01/04/2020	99.08231
01/05/2020	98.5806
01/06/2020	98.53065
01/07/2020	98.548
01/08/2020	98.75048
01/09/2020	99.06393
01/10/2020	99.21316
01/11/2020	99.16992
01/12/2020	99.173
01/01/2021	99.1791
01/02/2021	99.31915
01/03/2021	99.68667
01/04/2021	99.9318
01/05/2021	99.87289
01/06/2021	99.66229
01/07/2021	99.19262
01/08/2021	98.62153
01/09/2021	98.32172
01/10/2021	98.13444
01/11/2021	97.97153
01/12/2021	97.86975
01/01/2022	97.63383
01/02/2022	97.3252
01/03/2022	97.08676
01/04/2022	96.91986
01/05/2022	96.51163
01/06/2022	96.10297
01/07/2022	96.07491
01/08/2022	96.34187
01/09/2022	96.56104
01/10/2022	96.67527
01/11/2022	96.7423
01/12/2022	96.96549
01/01/2023	97.26425
01/02/2023	97.40134
01/03/2023	97.31264",header = TRUE)


# Convert DATE column to date format
df$DATE <- as.Date(df$DATE, format="%d/%m/%Y")

# Create a sequence of dates on a weekly time frame
all_dates <- seq(from=min(df$DATE), to=max(df$DATE), by="week")

# Create a new data frame with all_dates as the date column
new_df <- data.frame(DATE=all_dates)

# Merge the new data frame with the original data frame
df_merged <- merge(df, new_df, all=TRUE)

# Interpolate missing values
library(zoo)
df_merged$CCI <- na.approx(df_merged$CCI)

# Final output data frame
final_df <- df_merged

# Export final data frame as csv for further processing in Python
# write.csv(final_df, "C:\\Users\\Hriday Govind\\Documents\\MSc\\Thesis Final Submission\\Data\\CCI.csv", row.names = FALSE) # Uncomment if needed

